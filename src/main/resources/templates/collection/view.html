<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title></title>
  <link rel="stylesheet" type="text/css" href="/css/style.css">
</head>

<body>

<div class="layer collection-view-layer">
  <img class="x" th:src="@{/images/common/x.png}" onClick="closePopup();" alt="닫기">
  <div class="left-side">
    <img class="collection-image" th:if="${collection.attachedFiles == null or #lists.isEmpty(collection.attachedFiles)}"
         th:src="@{/images/collections/empty-collection.png}" alt="수집품 이미지 등록"
         onClick="triggerFileInput()">
    <th:block th:unless="${collection.attachedFiles == null or #lists.isEmpty(collection.attachedFiles)}">
      <th:block th:each="attachedFile : ${collection.attachedFiles}">
        <img class="collection-image" onClick="triggerFileInput()" alt="수집품 이미지"
             th:src="${'https://kr.object.ncloudstorage.com/bitcamp-moum/collection/' + attachedFile.filename}">
      </th:block>
    </th:block>
    <img id="preview" src="#" alt="미리보기" style="display: none;" onclick="triggerFileInput()">
    <div id="filenames">
      <th:block th:unless="${collection.attachedFiles == null or #lists.isEmpty(collection.attachedFiles)}">
        <th:block th:each="attachedFile : ${collection.attachedFiles}">
          <p th:text="${attachedFile.originFilename}"></p>
        </th:block>
      </th:block>
    </div>
  </div>
  <form class="right-side" action="/collection/update" method="post" enctype="multipart/form-data">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <input type="hidden" name="no" th:attr="value=${collection.no}" readonly>
    <input type="file" name="files" id="files" multiple onChange="previewImage(event);" style="display: none;">
    <table>
      <tr>
        <td><label for="name">상품 한글명</label></td>
        <td><input type="text" name="name" id="name" th:attr="value=${collection.name}"></td>
      </tr>
      <tr>
        <td><label for="enName">상품 영문명</label></td>
        <td><input type="text" name="enName" id="enName" th:attr="value=${collection.enName}"></td>
      </tr>
      <tr>
        <td><label for="price">가격</label></td>
        <td><input type="text" name="price" id="price" th:attr="value=${collection.price}"></td>
      </tr>
      <tr>
        <td><label for="maincategoryNo">대분류</label></td>
        <td>
          <select name="maincategoryNo" id="maincategoryNo" onChange="fetchSubcategories(this.value)">
            <option value="0">선택</option>
            <th:block th:each="maincategory : ${maincategoryList}">
              <option th:text="${maincategory.name}" th:attr="value=${maincategory.no}"
                      th:selected="${maincategory.no} == ${collection.maincategoryNo}"></option>
            </th:block>
          </select>
        </td>
      </tr>
      <tr>
        <td><label for="subcategoryNo">소분류</label></td>
        <td>
          <select name="subcategoryNo" id="subcategoryNo">
            <option value="0">선택</option>
            <th:block th:each="subcategory : ${subcategoryList}">
              <option th:text="${subcategory.name}" th:attr="value=${subcategory.no}"
                      th:selected="${subcategory.no} == ${collection.subcategoryNo}"></option>
            </th:block>
          </select>
        </td>
      </tr>
      <tr>
        <td><label for="purchasePlace">구매처</label></td>
        <td><input type="text" name="purchasePlace" id="purchasePlace" th:attr="value=${collection.purchasePlace}"></td>
      </tr>
      <tr>
        <td><label for="storageLocation">보관장소</label></td>
        <td><input type="text" name="storageLocation" id="storageLocation" th:attr="value=${collection.storageLocation}"></td>
      </tr>
      <tr>
        <td><label for="statusNo">상태</label></td>
        <td>
          <select name="statusNo" id="statusNo">
            <option value="0">선택</option>
            <th:block th:each="status : ${collectionStatusList}">
              <option th:text="${status.name}" th:attr="value=${status.no}"
                      th:selected="${status.no} == ${collection.statusNo}"></option>
            </th:block>
          </select>
        </td>
      </tr>
      <tr>
        <td><input type="submit" value="수정"></td>
        <td><button class="btn">POST</button></td>
      </tr>
    </table>
  </form>
</div>

</body>
</html>
